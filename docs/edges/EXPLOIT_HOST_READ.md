# EXPLOIT_HOST_READ

Exploit an arbitrary read from a sensitive host path mounted into the container to gain execution on the host.

| Source                                    | Destination                           | MITRE                            |
| ----------------------------------------- | ------------------------------------- |----------------------------------|
| [Container](../vertices/CONTAINER.md) | [Node](../vertices/NODE.md) | [Escape to Host, T1611](https://attack.mitre.org/techniques/T1611/) |

## Details

TODO

## Prerequisites

Execution within a privileged container process.

See the [example pod spec](../../test/setup/test-cluster/attacks/EXPLOIT_HOST_READ_TRAVERSE.yaml).

## Checks

TODO

## Exploitation

TODO

## Defences

### Monitoring

+ Monitor `mount` events originating from containers

### Implement security policies

Use a pod security policy or admission controller to prevent or limit the creation of pods with a `hostPath` mount of `/` or other sensitive locations.

### Least Privilege

Avoid running containers as the root user. Specify an unprivileged user account using the `securityContext`.

## Calculation

+ [ExploitHostRead](../../pkg/kubehound/graph/edge/exploit_host_read.go)

## References:

+ [HackTricks Docker Breakout](https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation)

