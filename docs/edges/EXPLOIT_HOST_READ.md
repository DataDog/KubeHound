# EXPLOIT_HOST_READ

Exploit an arbitrary read from a sensitive host path mounted into the container to gain execution on the host.

| Source                                    | Destination                           | MITRE                            |
| ----------------------------------------- | ------------------------------------- |----------------------------------|
| [Container](../vertices/CONTAINER.md) | [Node](../vertices/NODE.md) | [Escape to Host, T1611](https://attack.mitre.org/techniques/T1611/) |

## Details

If an

## Prerequisites

Execution within a container with a sensitive host path mounted as readonly.

See the [example pod spec](../../test/setup/test-cluster/attacks/EXPLOIT_HOST_READ_TRAVERSE.yaml).

## Checks

Check for interesting mounted volumes in the container as decribed in [VOLUME_MOUNT](./VOLUME_MOUNT.md#checks). Specifically:

+ `/etc`, `/root`, `/home`, `/proc` for SSH key material. This enables accessing the node via SSH (which is typically enabled for management functionality)

## Exploitation

#### SSH 


## Defences

### Monitoring

+ Monitor for access to sensitive host files (e.g SSH keys) originating from container processes

### Implement security policies

Use a pod security policy or admission controller to prevent or limit the creation of pods with a `hostPath` mount of `/` or other sensitive locations.

### Least Privilege

Avoid running containers as the root user. Specify an unprivileged user account using the `securityContext`.

## Calculation

+ [ExploitHostRead](../../pkg/kubehound/graph/edge/exploit_host_read.go)

## References:

None
