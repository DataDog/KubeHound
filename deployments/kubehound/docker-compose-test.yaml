version: "3.7"

services:
  mongodb:
    image: mongo
    container_name: storedb
    ports:
      - "127.0.0.1:27017:27017"
    volumes:
      - ./data/mongodb:/data/db

  # mongo-express:
  #   image: mongo-express
  #   restart: always
  #   depends_on:
  #     - mongodb
  #   ports:
  #     - "127.0.0.1:8081:8081"
  #   environment:
  #     ME_CONFIG_MONGODB_URL: mongodb://mongodb:27017/

  janusgraph:
    image: janusgraph-exp 
    container_name: graphdb-ng
    ports:
      - "127.0.0.1:8182:8182"
    volumes:
      - ./data/janus:/data
    environment:
      # - janusgraph.graph.timestamps=NANO
      - janusgraph.schema.constraints=true
      - janusgraph.schema.default=none
      # - janusgraph.storage.batch-loading=true
    #   - janusgraph.storage.batch-loading=true DOES NOT work with BerkelyJE backend
      # See: https://github.com/JanusGraph/janusgraph/issues/1623
      # - janusgraph.storage.berkeleyje.lock-mode=LockMode.READ_UNCOMMITTED
      # - janusgraph.storage.lock.wait-time=1000

  # https://github.com/JanusGraph/janusgraph-docker/blob/master/docker-compose-cql-es.yml
  # janusgraph:
  #   image: janusgraph-exp 
  #   container_name: jce-janusgraph
  #   environment:
  #     JANUS_PROPS_TEMPLATE: cql-es
  #     janusgraph.storage.hostname: jce-cassandra
  #     janusgraph.index.search.hostname: jce-elastic
  #   ports:
  #     - "127.0.0.1:8182:8182"
  #   healthcheck:
  #     test: ["CMD", "bin/gremlin.sh", "-e", "scripts/remote-connect.groovy"]
  #     interval: 10s
  #     timeout: 30s
  #     retries: 3

  # cassandra:
  #   image: cassandra:latest
  #   container_name: jce-cassandra
  #   ports:
  #     - "127.0.0.1:9042:9042"
  #     - "127.0.0.1:9160:9160"

  # elasticsearch:
  #   image: docker.elastic.co/elasticsearch/elasticsearch:6.6.0
  #   container_name: jce-elastic
  #   environment:
  #     - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
  #     - "http.host=0.0.0.0"
  #     - "network.host=0.0.0.0"
  #     - "transport.host=127.0.0.1"
  #     - "cluster.name=docker-cluster"
  #     - "xpack.security.enabled=false"
  #     - "discovery.zen.minimum_master_nodes=1"
  #   ports:
  #     - "127.0.0.1:9200:9200"
